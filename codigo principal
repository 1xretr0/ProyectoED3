//proyecto Final equipo 1
//Mau Solano  Emma Gudino  Sebas Moran
//Empresa que procesa pagos con tarjeta online, este es un programa que registra esos pagos

#include <stdio.h>
#include <stdlib.h>
#include <conio.h>
#include <windows.h>
#include <time.h>
#include <iostream>
#include <D:\Docs\UPAEP\Estructura de Datos\libreriascustom\asciiart.h>
using namespace std;

//creacion estructura para los datos de la fecha
struct datos_fecha{
    int dia;
    int mes;
    int year;
};

//creacion estructura datos del pago, estructura de fecha anidada
struct pago{
    int codigo;
    char remitente[20];
    char beneficiario[20];
    struct datos_fecha fecha;
    float monto;
    pago *siguiente;
};
pago *pila = NULL;

//declaracion global del archivo a emplear
FILE *archivo;
//prototipo de funciones para pilas
void ingresarstack(); 
void imprimirstack();
void eliminarstack(int);

int main(void){
    system("cls");
    system("color 02");
    srand(time(NULL));
    ascii_art();
    //presentacion
    cout<<"\tProyecto Final"<<endl;
    cout<<"Mau Solano\tMario Gudino\tSebas Moran"<<endl;
    cout<<"\n\nEmpresa que procesa Pagos con Tarjeta online"<<endl;
    cout<<"Este programa registra los datos de dichos pagos."<<endl;
    getch();

    int op; //ciclo del menu general
    while (op != 5){
        system("cls");
        cout<<"MENU PRINCIPAL\n"<<endl;
        cout<<"1)STACKS\n2)QUEUES\n3)LISTAS\n4)ARCHIVOS\n5)SALIR\n"<<endl;
        cout<<"Seleccione una Opcion: ";
        cin>>op;

        switch (op){
            case 1:{ //pilas
                 //ciclo de menu de pilas
                int op1 = 0;
                int cont = 0;
                while (op1 != 4){
                    system("cls");
                    cout<<"STACKS/PILAS\n"<<endl;
                    cout<<"Seleccione: 1)ALMACENAR 2)IMPRIMIR 3)ELIMINAR 4)VOLVER"<<endl;
                    cin>>op1;
                    switch (op1){
                        case 1:{
                            system("cls");
                            cout<<"ALMACENAR\n"<<endl;
                            cont ++;
                            ingresarstack();
                            break;
                        }
                        case 2: {
                            system("cls");
                            cout<<"IMPRIMIR\n"<<endl;
                            if (cont > 0){
                                cont --;
                            }
                            imprimirstack();
                            getch();
                            break;
                        }
                        case 3:{
                            system("cls");
                            cout<<"ELIMINAR\n"<<endl;

                            cout<<"Cuantos elementos dar de baja?: ";
                            int aux;
                            cin>>aux;
                            if (aux <= cont){
                                cont -= aux;
                                eliminarstack(aux);
                            }
                            else{
                                cout<<"Solo existen "<<cont<<" elementos actualmente."<<endl;
                                getch();
                            }
                            break;
                        }
                        case 4:{
                            system("cls");
                            //en este caso solo se cierra el ciclo de este menu y vuelve al menu general
                            break;
                        }
                        default:{
                            cout<<"Opcion Ingresada NO valida"<<endl;
                            getch();
                            break;
                        }
                    }
                }
                break;
            }
            case 2:{ //colas
                system("cls");
                cout<<"QUEUES\n"<<endl;
                getch();
                break;
            }
            case 3:{ //listas
                system("cls");
                cout<<"LISTAS\n"<<endl;
                
                break;
            }
            case 4:{ //archivos
                system("cls");
                cout<<"ARCHIVOS\n"<<endl;

                break;
            }
            case 5:{ //salir
                system("cls");
                cout<<"SALIR"<<endl;
                break;
            }
            default:{ //caso estandar de error
                system("cls");
                cout<<"Opcion Ingresada No valida"<<endl;
                getch();
                break;
            }
        }
    }
    
}

//funcion ingreso datos a pila
void ingresarstack(){
    pago *nuevopago = new pago();
    nuevopago->codigo = 1+rand()%(101-1);
    cout<<"Ingrese Remitente del Pago: ";
    //un pequeno problema aqui, solo me deja ingresar un string con la funcion scanf, no funciona otra no se porque
    //el detalle es que con scanf no se pueden ingresar strings con espacios, entonces el nombre del remitente solo se puede ingresar nombre
    //ya que si ingresas nombre espacio apellido saldra un error que tu mismo puedes comprobar
    scanf("%s", &nuevopago->remitente);
    cout<<"Ingrese Beneficiario del Pago: ";
    scanf("%s", &nuevopago->beneficiario);
    cout<<"Ingrese Fecha (dia, mes, year):"<<endl;
    //validacion dia del mes en proceso
    cin>>nuevopago->fecha.dia;
    while (nuevopago->fecha.dia <= 0 || nuevopago->fecha.dia > 31){
        cout<<"\e[A";
        cin>>nuevopago->fecha.dia;
    }
    cin>>nuevopago->fecha.mes;
    cin>>nuevopago->fecha.year;
    cout<<"Ingrese Monto: $";
    cin>>nuevopago->monto;
            
    nuevopago->siguiente = pila;
    pila = nuevopago;
}

//funcion extraccion de datos a la pila
void imprimirstack(){
    while (pila != NULL){
        pago *aux = pila;
        cout<<aux->codigo<<"\t";
        cout<<aux->remitente<<"\t";
        cout<<aux->beneficiario<<"\t";
        cout<<aux->fecha.dia<<"/"<<aux->fecha.mes<<"/"<<aux->fecha.year<<"\t";
        cout<<"$"<<aux->monto<<"\n";

        pila = aux->siguiente;
    }
}

void eliminarstack(int n){
    for(int i = 0; i < n; i++){
        pago *auxnodo = pila;
        pila = auxnodo->siguiente;
        delete auxnodo;
    }
}

